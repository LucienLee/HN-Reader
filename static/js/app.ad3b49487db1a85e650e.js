webpackJsonp([1],{117:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(70),r=n.n(i),s=n(54),o=n(126),a=(n.n(o),n(128)),c=n(273),u=n.n(c),f=n(296);s.a.config.productionTip=!1,r()(f).forEach(function(t){s.a.filter(t,f[t])}),new s.a({el:"#app",store:a.a,render:function(t){return t(u.a)}})},126:function(t,e){},128:function(t,e,n){"use strict";var i=n(54),r=n(77),s=n(129),o=n(271),a=n(272);i.a.use(r.a),e.a=new r.a.Store({state:{list:[],items:{},itemsPerPage:20,reservedIDs:750,nextToFetchID:0,isOnline:!0,isLoading:!0},actions:s.a,mutations:o.a,getters:a.a,strict:!1})},129:function(t,e,n){"use strict";function i(){return JSON.parse(localStorage.getItem("state"))}var r=n(55),s=n.n(r),o=n(58),a=n.n(o),c=n(59),u=n.n(c),f=n(158),l=n.n(f),d=n(160),m=n(208),h=n(116),p=!1,v=0,g=Object(h.a)(function(t){localStorage.setItem("state",l()({list:t.list,items:t.items,nextToFetchID:t.nextToFetchID,timestamp:Date.now()}))},200);e.a={getNewestList:function(t){var e=this,n=t.commit,i=t.state;return u()(a.a.mark(function t(){var r,s;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(r=Date.now()-v>18e4,0!==i.list.length&&!r){t.next=8;break}return t.next=4,Object(d.d)();case 4:s=t.sent,n("SET_ENTIRE_LIST",{list:s}),n("SET_NEXT_TO_FETCH",{id:s[0]}),n("CLEAN_ITEMS");case 8:case"end":return t.stop()}},t,e)}))()},getItems:function(t){var e=this,n=t.state,i=t.commit,r=t.dispatch,o=t.getters;return u()(a.a.mark(function t(){var c,u,f,l,m,h,v;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return i("SET_LOADING",{isLoading:!0}),c=n.list,u=n.itemsPerPage,f=o.nextToFetchIndex,l=-1===f?0:Math.min(c.length-f,u),m=u-l,h=c.slice(f,f+l),m>0&&(p=!0),t.next=9,s.a.all(h.map(function(t){return r("getItemByID",{id:t})})).then(function(){var t=l>0&&o.nextToFetchIndex+l<c.length?c[o.nextToFetchIndex+l]:c[c.length-1]-1;return i("SET_NEXT_TO_FETCH",{id:t}),t});case 9:if(v=t.sent,!(m>0)){t.next=13;break}return t.next=13,Object(d.c)(v,m,function(t){i("SET_ITEM",{item:t}),i("SET_LIST",{ids:[t.id]})}).then(function(t){i("SET_NEXT_TO_FETCH",{id:t}),p=!1});case 13:i("SET_LOADING",{isLoading:!1}),g(n);case 15:case"end":return t.stop()}},t,e)}))()},getItemByID:function(t,e){var n=t.commit,i=e.id;return Object(d.b)(i).then(function(t){return n("SET_ITEM",{item:t}),t})},getDataFromStorage:function(t){var e=t.commit,n=i(),r=n.list,s=n.items,o=n.nextToFetchID,a=n.timestamp;e("SET_LIST",{ids:r}),e("SET_NEXT_TO_FETCH",{id:o}),e("SET_ITEMS",{items:s}),v=a},watchWaitToFetchList:function(t){var e=function(){var t=u()(a.a.mark(function t(){var o;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(0===i.list.length||p){t.next=6;break}if(o=i.reservedIDs-r.numOfWaitToFetchIDs,s||!(o>0)){t.next=6;break}return s=!0,t.next=6,Object(d.a)(i.list[i.list.length-1]-1,o,function(t){p||(n("SET_LIST",{ids:[t]}),-1===r.nextToFetchIndex&&n("SET_NEXT_TO_FETCH",{id:t}))}).then(function(){s=!1});case 6:requestAnimationFrame(e);case 7:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),n=t.commit,i=t.state,r=t.getters,s=!1,o=requestAnimationFrame(e);return function(){cancelAnimationFrame(o)}},watchNewStories:function(t){var e=this,n=t.commit,i=t.state,r=t.dispatch;return Object(d.f)(function(){var t=u()(a.a.mark(function t(o){var c,u;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:c=Object(m.a)(o,i.list),u=s.a.all(c.map(function(t){return r("getItemByID",{id:t})})),n("SET_LIST",{ids:c.filter(function(t,e){return u[e]})}),g(i);case 4:case"end":return t.stop()}},t,e)}));return function(e){return t.apply(this,arguments)}}())},detechConnection:function(t){var e=t.commit;Object(d.e)(function(t){e("SET_ONLINE",{isOnline:t||window.navigator.onLine})})}}},160:function(t,e,n){"use strict";function i(t){return new h.a(function(e,n){S.child(t).once("value",function(t){var n=t.val();e(n)},n)})}function r(){return i("newstories")}function s(t){return i("item/"+t)}function o(t){return i("item/"+t+"/type")}function a(t){var e=!0,n=S.child("newstories"),i=function(n){e?e=!1:t(n.val())};return n.on("value",i),function(){n.off("value",i)}}function c(t){x.on("value",function(e){t(e.val())})}n.d(e,"d",function(){return r}),n.d(e,"b",function(){return s}),n.d(e,"c",function(){return g}),n.d(e,"a",function(){return w}),n.d(e,"f",function(){return a}),n.d(e,"e",function(){return c});var u=n(58),f=n.n(u),l=n(59),d=n.n(l),m=n(55),h=n.n(m),p=n(32),v=(n.n(p),n(168)),g=(n.n(v),function(){var t=d()(f.a.mark(function t(e,n,i){var r,o,a;return f.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:r=e,o=n;case 2:if(!(o>0&&r>0)){t.next=10;break}return t.next=5,s(r);case 5:a=t.sent,a&&"story"===a.type&&(o-=1,i(a)),r-=1,t.next=2;break;case 10:return t.abrupt("return",h.a.resolve(r));case 11:case"end":return t.stop()}},t,this)}));return function(e,n,i){return t.apply(this,arguments)}}()),w=function(){var t=d()(f.a.mark(function t(e,n,i){var r,s,a;return f.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:r=e,s=n;case 2:if(!(s>0&&r>0)){t.next=10;break}return t.next=5,o(r);case 5:a=t.sent,"story"===a&&(s-=1,i(r)),r-=1,t.next=2;break;case 10:return t.abrupt("return",h.a.resolve(r));case 11:case"end":return t.stop()}},t,this)}));return function(e,n,i){return t.apply(this,arguments)}}(),T={version:"/v0",config:{databaseURL:"https://hacker-news.firebaseio.com"}},I=p.initializeApp(T.config),S=I.database().ref(T.version),x=I.database().ref(".info/connected")},271:function(t,e,n){"use strict";var i=n(54);e.a={SET_LIST:function(t,e){var n=e.ids;t.list=t.list.concat(n).sort(function(t,e){return e-t})},SET_ENTIRE_LIST:function(t,e){var n=e.list;t.list=n},SET_ITEM:function(t,e){var n=e.item;n&&i.a.set(t.items,n.id,n)},SET_ITEMS:function(t,e){var n=e.items;t.items=n},CLEAN_ITEMS:function(t){t.items={}},SET_NEXT_TO_FETCH:function(t,e){var n=e.id;t.nextToFetchID=n},SET_LOADING:function(t,e){var n=e.isLoading;t.isLoading=n},SET_ONLINE:function(t,e){var n=e.isOnline;t.isOnline=n}}},272:function(t,e,n){"use strict";var i=n(70),r=n.n(i);e.a={nextToFetchIndex:function(t){return t.list.indexOf(t.nextToFetchID)},numOfWaitToFetchIDs:function(t){return-1===t.list.indexOf(t.nextToFetchID)?0:t.list.length-t.list.indexOf(t.nextToFetchID)},displayedItems:function(t){return r()(t.items).sort(function(t,e){return e-t}).map(function(e){return t.items[e]}).filter(function(t){return!t.dead&&!t.deleted})},numOfItems:function(t){return r()(t.items).length},deadItems:function(t){return r()(t.items).sort(function(t,e){return e-t}).map(function(e){return t.items[e]}).filter(function(t){return t.dead||t.deleted})}}},273:function(t,e,n){function i(t){n(274)}var r=n(46)(n(275),n(295),i,null,null);t.exports=r.exports},274:function(t,e){},275:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(58),r=n.n(i),s=n(59),o=n.n(s),a=n(276),c=n.n(a),u=n(77),f=n(116),l=n(283),d=n.n(l),m=n(287),h=n.n(m),p=n(291),v=n.n(p);e.default={name:"app",components:{Item:d.a,Spinner:h.a,Tip:v.a},data:function(){return{color:"#ff6600",lastScrollY:0,isInitWithConnection:!1,ticking:!1,messages:{error:"You lost the internet. Please check your network connection!",normal:"Welcome back to internet."}}},computed:{isOnline:function(){return this.$store.state.isOnline},isLoading:function(){return this.$store.state.isLoading},displayedItems:function(){return this.$store.getters.displayedItems}},methods:c()({},Object(u.b)(["getItems","getNewestList","watchWaitToFetchList","watchNewStories","detechConnection","getDataFromStorage"]),{initWithConnection:function(){var t=this;return o()(r.a.mark(function e(){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getNewestList();case 2:return t.getItems(),e.next=5,t.watchWaitToFetchList();case 5:return t.unwatchWaitToFetchList=e.sent,e.next=8,t.watchNewStories();case 8:t.unwatchNewStories=e.sent,t.isInitWithConnection=!0;case 10:case"end":return e.stop()}},e,t)}))()},onScroll:function(){this.lastScrollY=window.scrollY,this.isOnline&&!this.isLoading&&this.lastScrollY+window.innerHeight>=document.body.scrollHeight&&this.getItems()}}),mounted:function(){var t=this;return o()(r.a.mark(function e(){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.detechConnection();case 2:t.isOnline?t.initWithConnection():t.getDataFromStorage(),window.addEventListener("scroll",Object(f.a)(t.onScroll,100));case 4:case"end":return e.stop()}},e,t)}))()},beforeDestroy:function(){this.unwatchWaitToFetchList(),this.unwatchNewStories()},watch:{isOnline:function(){this.isInitWithConnection||this.initWithConnection()}}}},283:function(t,e,n){function i(t){n(284)}var r=n(46)(n(285),n(286),i,"data-v-1d82bc84",null);t.exports=r.exports},284:function(t,e){},285:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={props:["item"],methods:{normalizeURL:function(t){return t.url?t.url:"https://news.ycombinator.com/item?id="+t.id}}}},286:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("li",{staticClass:"item"},[n("span",{staticClass:"score"},[t._v(t._s(t.item.score))]),n("p",{staticClass:"title"},[n("a",{staticClass:"link",attrs:{href:t.normalizeURL(t.item),target:"_blank"}},[t._v(t._s(t.item.title))]),t.item.url?n("span",{staticClass:"host"},[t._v(" ("+t._s(t._f("host")(t.item.url))+")")]):t._e()]),n("span",{staticClass:"meta"},[n("span",{staticClass:"time"},[t._v(t._s(t._f("timeAgo")(t.item.time))+" ago")]),n("span",{staticClass:"comments"},[t._v(" | "+t._s(t.item.descendants)+" comments")])])])},staticRenderFns:[]}},287:function(t,e,n){function i(t){n(288)}var r=n(46)(n(289),n(290),i,"data-v-86e1a484",null);t.exports=r.exports},288:function(t,e){},289:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={props:{color:{type:String,default:"#fff"},size:{type:Number,default:18}},data:function(){return{dots:3,dotStyle:{width:this.size+"px",height:this.size+"px",margin:this.size/6+"px",backgroundColor:this.color}}},methods:{delay:function(t){return{animationDelay:-.16*(this.dots-t)+"s"}}}}},290:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"spinner"},t._l(t.dots,function(e){return n("div",{staticClass:"bounce",style:[t.dotStyle,t.delay(e)]})}))},staticRenderFns:[]}},291:function(t,e,n){function i(t){n(292)}var r=n(46)(n(293),n(294),i,"data-v-706c0c80",null);t.exports=r.exports},292:function(t,e){},293:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={name:"tip",props:{status:{type:Boolean,required:!0},messages:{type:Object,required:!0},width:{type:Number,default:600}},data:function(){return{colors:{normal:"#80d580",error:"#f68787"},isShow:!this.status}},computed:{info:function(){return this.status?this.messages.normal:this.messages.error},statusStyle:function(){return{backgroundColor:this.status?this.colors.normal:this.colors.error}},tipStyle:function(){return{width:this.width+"px"}}},watch:{status:function(t){var e=this;t?setTimeout(function(){e.isShow=!1},1e3):this.isShow=!0}}}},294:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("transition",{attrs:{name:"slide-delay"}},[t.isShow?n("div",{staticClass:"tip",style:t.tipStyle},[n("div",{staticClass:"status",style:t.statusStyle}),n("span",{staticClass:"content"},[t._v(t._s(t.info))])]):t._e()])},staticRenderFns:[]}},295:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"app"}},[n("header",{on:{click:function(e){t.isOnline=!t.isOnline}}},[n("img",{staticClass:"logo",attrs:{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAAAXNSR0IArs4c6QAAA75JREFUeAHtWDtrFUEUTnxAfD8a0cJSFP9CwCJ1LCxSXxsxYBdtJGApgthZaGmdQvwB6TRgZSMoCILgG0VIIkIi+s3e2XtnvnmcnXvN3sWZgWHPOfN935k5Ozt7905NlVYqUCqQcwWmefF/0Dj2P/nTaOZ6dplOjnYpQI533VzzHtPx2fzM+DBdjklnWnkEunz32phb2QFtVLnLOcRDsMnkcdCcCOA2cIhuBsYahaF9AMCDPjC0P/viY8XUqWm2JmLAr5gcw15two9hoLVq6JnmSoxXj5kEZdfx4DWZACVwzqJvM1f7c8FkwgD4cwHNLcTPCPRqmPkiJ5mgFcF7yFztr4lJAwDw1wKa9wMUJ8x8B8CBZIIWAO8U+k/ma3+e80g+ePMBrXXEQ2eOI8saDoADyQRDANzbzNf+C1ytrzCD5pgKi644vnbLIUQCLBCB9oeSCYYiuEfRv7GG9hcMaNQEfiGg8Qlx7xshJMg6IdwgnkwYMPsG+NdZQ/uvcN1NcMdVGHSF9bWrDkEIsIgAr050iyMSCADyDPo7S2To9AjuuID2hnDLeg0v+XeLpQDHSciBZAILwIfGZdbR/ltc93ooVUiNoSuMr10K8WJxFoph60lYHJHgAUBAbeOXltDQWfRQ6tyLQ5hlPQtxpLilAkfCq7tnNZEQAEDkoiU0dN7DnGEaYvvQ1ZivzTK+qc9iIi+ZEFGE1lPW0/4S0xBfCmAfMzbFZ02Rm0yIKEJrlvW0/xXXwetM2egqxk39vD4XSSEOseC/JwiKmMATnoT2l2sq/OUA5kGNGfXKuqJOMkFQhN559N+sC/8H+jHdlc1tE4GTgrw4zKJMSH6vsoDk45tdvQ0eAdcj7BH4N3RM2dzugfuRgzvuSxUbZQLQPI3+i7Xhb+jOQ18QODRKLuawMI87fjLBUfAHoHuXtSP+Nb9KepRziArJBFGxD4DucXTfs84p3yAQ/LXYMN0AxuKDAW209q8wnufvyHmHJ+DxbwK75Ym3E5IqNs4soL0f/QPnMPznsBv/b9BkLoZ2ZYqcZIKoaAOgf4VzGP4FGz2+Z2hXJis61VYoE4Tt6GDM8VQb8urV69vi60h1OFVPwkvrae0MqCeKRW7Dtopcj03i2noBJrHIWM5SgFh1chgrOyCHuxxbY9kBserkMFZ2QA53ObbGsgNi1clhLPsdsON/igZ2ke/f3ol8IDmfutLnY2BBnQ1L68n+ESgF6OzebWli2e8A8S3Ah0hLN6a1NNnvgFKA1vZaSVQqUCpQKtDBCvwFqj/5DXLg230AAAAASUVORK5CYII="}})]),n("main",[n("tip",{attrs:{messages:t.messages,status:t.isOnline}}),n("ul",{staticClass:"item-list"},t._l(t.displayedItems,function(t){return n("item",{key:t.id,attrs:{item:t}})})),n("spinner",{directives:[{name:"show",rawName:"v-show",value:t.isLoading,expression:"isLoading"}],attrs:{color:t.color}})],1)])},staticRenderFns:[]}},296:function(t,e,n){"use strict";function i(t,e){return 1===t?t+e:t+e+"s"}function r(t){return~~t}function s(t){var e=t.replace(/^https?:\/\//,"").replace(/\/.*$/,""),n=e.split(".").slice(-3);return"www"===n[0]&&n.shift(),n.join(".")}function o(t){var e=Date.now()/1e3-Number(t);return e<3600?i(r(e/60)," minute"):e<86400?i(r(e/3600)," hour"):i(r(e/86400)," day")}Object.defineProperty(e,"__esModule",{value:!0}),n.d(e,"host",function(){return s}),n.d(e,"timeAgo",function(){return o})}},[117]);
//# sourceMappingURL=app.ad3b49487db1a85e650e.js.map